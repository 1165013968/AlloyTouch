(function(){"use strict";var i,n,t,r;for(Date.now||(Date.now=function(){return(new Date).getTime()}),i=["webkit","moz"],n=0;n<i.length&&!window.requestAnimationFrame;++n)t=i[n],window.requestAnimationFrame=window[t+"RequestAnimationFrame"],window.cancelAnimationFrame=window[t+"CancelAnimationFrame"]||window[t+"CancelRequestAnimationFrame"];!/iP(ad|hone|od).*OS 6/.test(window.navigator.userAgent)&&window.requestAnimationFrame&&window.cancelAnimationFrame||(r=0,window.requestAnimationFrame=function(n){var t=Date.now(),i=Math.max(r+16,t);return setTimeout(function(){n(r=i)},i-t)},window.cancelAnimationFrame=clearTimeout)})(),function(){function t(n,t,i){n.addEventListener(t,i,!1)}function n(n){return Math.sqrt(1-Math.pow(n-1,2))}function r(n){return 1-Math.sqrt(1-n*n)}function u(n,t){for(var i in t)if(t[i].test(n[i]))return!0;return!1}var i=function(n){this.element=typeof n.touch=="string"?document.querySelector(n.touch):n.touch;this.target=this._getValue(n.target,this.element);this.vertical=this._getValue(n.vertical,!0);this.property=n.property;this.tickID=0;this.initialVaule=this._getValue(n.initialVaule,this.target[this.property]);this.target[this.property]=this.initialVaule;this.fixed=this._getValue(n.fixed,!1);this.sensitivity=this._getValue(n.sensitivity,1);this.moveFactor=this._getValue(n.moveFactor,1);this.factor=this._getValue(n.factor,1);this.outFactor=this._getValue(n.outFactor,.3);this.min=n.min;this.max=n.max;this.deceleration=.0006;this.maxRegion=this._getValue(n.maxRegion,60);var i=function(){};if(this.change=n.change||i,this.touchEnd=n.touchEnd||i,this.touchStart=n.touchStart||i,this.touchMove=n.touchMove||i,this.touchCancel=n.touchCancel||i,this.reboundEnd=n.reboundEnd||i,this.animationEnd=n.animationEnd||i,this.correctionEnd=n.correctionEnd||i,this.tap=n.tap||i,this.pressMove=n.pressMove||i,this.preventDefault=this._getValue(n.preventDefault,!0),this.preventDefaultException={tagName:/^(INPUT|TEXTAREA|BUTTON|SELECT)$/},this.hasMin=!(this.min===undefined),this.hasMax=!(this.max===undefined),this.hasMin&&this.hasMax&&this.min>this.max)throw"the min value can't be greater than the max value.";this.isTouchStart=!1;this.step=n.step;this.inertia=this._getValue(n.inertia,!0);this._calculateIndex();this.eventTarget=window;n.bindSelf&&(this.eventTarget=this.element);this._moveHandler=this._move.bind(this);t(this.element,"touchstart",this._start.bind(this));t(this.eventTarget,"touchend",this._end.bind(this));t(this.eventTarget,"touchcancel",this._cancel.bind(this));this.eventTarget.addEventListener("touchmove",this._moveHandler,{passive:!1,capture:!1});this.x1=this.x2=this.y1=this.y2=null};i.prototype={_getValue:function(n,t){return n===undefined?t:n},_start:function(n){this.isTouchStart=!0;this.touchStart.call(this,n,this.target[this.property]);cancelAnimationFrame(this.tickID);this._calculateIndex();this.startTime=(new Date).getTime();this.x1=this.preX=n.touches[0].pageX;this.y1=this.preY=n.touches[0].pageY;this.start=this.vertical?this.preY:this.preX},_move:function(n){var e;if(this.isTouchStart){var o=n.touches.length,t=n.touches[0].pageX,i=n.touches[0].pageY,r=(this.vertical?i-this.preY:t-this.preX)*this.sensitivity,f=this.moveFactor;this.hasMax&&this.target[this.property]>this.max&&r>0?f=this.outFactor:this.hasMin&&this.target[this.property]<this.min&&r<0&&(f=this.outFactor);r*=f;this.preX=t;this.preY=i;this.fixed||(this.target[this.property]+=r);this.change.call(this,this.target[this.property]);e=(new Date).getTime();e-this.startTime>300&&(this.startTime=e,this.start=this.vertical?this.preY:this.preX);this.touchMove.call(this,n,this.target[this.property]);this.preventDefault&&!u(n.target,this.preventDefaultException)&&n.preventDefault();o===1&&(this.x2!==null?(n.deltaX=t-this.x2,n.deltaY=i-this.y2):(n.deltaX=0,n.deltaY=0),this.pressMove.call(this,n,this.target[this.property]));this.x2=t;this.y2=i}},_cancel:function(t){var i=this.target[this.property];this.touchCancel.call(this,t,i);this.hasMax&&i>this.max?this._to(this.max,200,n,this.change,function(n){this.reboundEnd.call(this,n);this.animationEnd.call(this,n)}.bind(this)):this.hasMin&&i<this.min?this._to(this.min,200,n,this.change,function(n){this.reboundEnd.call(this,n);this.animationEnd.call(this,n)}.bind(this)):this._correction();this.x1=this.x2=this.y1=this.y2=null},to:function(t,i,r){this._to(t,this._getValue(i,600),r||n,this.change,function(n){this._calculateIndex();this.reboundEnd.call(this,n);this.animationEnd.call(this,n)}.bind(this))},_calculateIndex:function(){this.hasMax&&this.hasMin&&(this.currentPage=Math.round((this.max-this.target[this.property])/this.step))},_end:function(t){var i,f,o,a;if(this.isTouchStart){if(this.isTouchStart=!1,i=this,f=this.target[this.property],Math.abs(t.changedTouches[0].pageX-this.x1)<30&&Math.abs(t.changedTouches[0].pageY-this.y1)<30&&this.tap.call(this,t,f),this.touchEnd.call(this,t,f,this.currentPage)===!1)return;if(this.hasMax&&f>this.max)this._to(this.max,200,n,this.change,function(n){this.reboundEnd.call(this,n);this.animationEnd.call(this,n)}.bind(this));else if(this.hasMin&&f<this.min)this._to(this.min,200,n,this.change,function(n){this.reboundEnd.call(this,n);this.animationEnd.call(this,n)}.bind(this));else if(this.inertia)if(o=(new Date).getTime()-this.startTime,o<300){var h=((this.vertical?t.changedTouches[0].pageY:t.changedTouches[0].pageX)-this.start)*this.sensitivity,c=Math.abs(h)/o,l=this.factor*c,e=f+l*l/(2*this.deceleration)*(h<0?-1:1),s=1;e<this.min-this.maxRegion?(s=r((f-this.min+this.maxRegion)/(f-e)),e=this.min-this.maxRegion):e>this.max+this.maxRegion&&(s=r((this.max+this.maxRegion-f)/(e-f)),e=this.max+this.maxRegion);a=Math.round(c/i.deceleration)*s;i._to(Math.round(e),a,n,i.change,function(t){i.hasMax&&i.target[i.property]>i.max?(cancelAnimationFrame(i.tickID),i._to(i.max,600,n,i.change,i.animationEnd)):i.hasMin&&i.target[i.property]<i.min?(cancelAnimationFrame(i.tickID),i._to(i.min,600,n,i.change,i.animationEnd)):i._correction();i.change.call(this,t)})}else i._correction();else i._correction();this.preventDefault&&!u(t.target,this.preventDefaultException)&&t.preventDefault()}this.x1=this.x2=this.y1=this.y2=null},_to:function(n,t,i,r,u){if(!this.fixed){var f=this.target,e=this.property,s=f[e],c=n-s,l=new Date,o=this,h=function(){var a=new Date-l;if(a>=t){f[e]=n;r&&r.call(o,n);u&&u.call(o,n);return}f[e]=c*i(a/t)+s;o.tickID=requestAnimationFrame(h);r&&r.call(o,f[e])};h()}},_correction:function(){if(this.step!==undefined){var r=this.target,u=this.property,t=r[u],i=Math.floor(Math.abs(t/this.step)),f=t%this.step;Math.abs(f)>this.step/2?this._to((t<0?-1:1)*(i+1)*this.step,400,n,this.change,function(n){this._calculateIndex();this.correctionEnd.call(this,n);this.animationEnd.call(this,n)}.bind(this)):this._to((t<0?-1:1)*i*this.step,400,n,this.change,function(n){this._calculateIndex();this.correctionEnd.call(this,n);this.animationEnd.call(this,n)}.bind(this))}}};typeof module!="undefined"&&typeof exports=="object"?module.exports=i:window.AlloyTouch=i}()